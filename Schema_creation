USE ROLE sysadmin;       --> Select Role
USE WAREHOUSE compute_wh; ---> Select compute

--> Create a database called cricket and 4 schemas
CREATE DATABASE IF NOT EXISTS cricket;
CREATE OR REPLACE SCHEMA cricket.land;
CREATE OR REPLACE SCHEMA cricket.raw;
CREATE OR REPLACE SCHEMA cricket.clean;
CREATE OR REPLACE SCHEMA cricket.consumption;

SHOW SCHEMAS IN DATABASE CRICKET;

--> Change context
USE SCHEMA cricket.land;

--> JSON file format
CREATE OR REPLACE FILE FORMAT cricket.land.my_json_format
     type = json
     null_if = ('\\n','null', ' ')
     strip_outer_array = true
     comment = 'Json File Format with Outer Stip array flag true';

--> Creating an internal stage
CREATE OR REPLACE STAGE cricket.land.my_stg;

USE SCHEMA land;

--> List the internal stage
LIST @cricket.land.my_stg;

--> Check if data is being loaded or not
LIST @my_stg/cricket/json/;


--> Quick check if data is coming correctly or not
SELECT 
     t.$1:meta::variant as meta,
     t.$1:info::variant as info,
     t.$1:innings::array as innings,
     metadata$filename as file_name,
     metadata$file_row_number int,
     metadata$file_content_key text,
     metadata$file_last_modified as stg_modified_ts
    FROM @my_stg/cricket/json/951373.json (file_format => 'my_json_format') t ;


